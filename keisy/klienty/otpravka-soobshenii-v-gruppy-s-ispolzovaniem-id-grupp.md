# Отправка сообщений в группы с использованием ID групп

{% hint style="warning" %}
Функционал описанный в данной статье предполагает использование активити бизнес-процессов, которые доступны для архивных тарифов Команда, CRM+ и Компания, а также в действующих тарифах Профессиональный и Энтерпрайз
{% endhint %}

Рассмотрим ситуацию, когда вам необходимо автоматизированно отправлять сообщения в подключенную группу WhatsApp. Для этого вы можете явно указать в роботе или в активити бизнес-процесса группу, в которую нужно отправить сообщение. Однако, в некоторых случаях может потребоваться изменить группу, в которую делается отправка. Чтобы не переходить каждый раз когда нужно изменить группу в настройки роботов или бизнес-процессов, можно воспользоваться другим способом – передавать информацию о группе, в которую отправляется сообщение в виде ID этой группы, а ID группы, в свою очередь, хранить в поле карточки сущности.

Для этого потребуется:

1. Создать пользовательское поле в карточке сущности «ID Группы».
2. Получить ID группы в интерфейсе настроек групповых чатов и записать его в созданное пользовательское поле «ID Группы».
3. Добавить активити бизнес-процесса для отправки сообщения и передать в него в поле «Группа или ID группы» значение из пользовательского поля «ID Группы».

Выполним пошаговую настройку данного сценария.

Создадим пользовательское поле типа «Строка» в карточке сущности:

<figure><img src="../../.gitbook/assets/image (29).png" alt=""><figcaption></figcaption></figure>

Задайте название полю «ID Группы» и нажмите на кнопку «СОХРАНИТЬ»:

<figure><img src="../../.gitbook/assets/image (30).png" alt=""><figcaption></figcaption></figure>

Далее, необходимо получить ID группы и сохранить его в созданном пользовательском поле. Для получения ID группы необходимо перейти в приложение «OLChat» в левом меню портала и в открывшемся приложении выбрать пункт меню «Настройки групп»:

<figure><img src="../../.gitbook/assets/image (31).png" alt=""><figcaption></figcaption></figure>

В списке подключенных групп выберите группу, для которой необходимо получить ID группы и нажмите на набор цифр напротив ID группы. ID группы будет скопирован в буфер обмена и вы получите соответствующее уведомление:

<figure><img src="../../.gitbook/assets/image (32).png" alt=""><figcaption></figcaption></figure>

Вернитесь в сущность, в которой создавали пользовательское поле «ID Группы», заполните его скопированным значением и нажмите на кнопку «СОХРАНИТЬ»:

<figure><img src="../../.gitbook/assets/image (33).png" alt=""><figcaption></figcaption></figure>

На следующем шаге можно приступать к настройкам активити бизнес-процесса. Добавьте любое активити для отправки сообщений в группы. Например, «\[OLChat] \[Группы] Отправка сообщения»:

<figure><img src="../../.gitbook/assets/image (34).png" alt=""><figcaption></figcaption></figure>

Выполните его настройку:

<figure><img src="../../.gitbook/assets/image (35).png" alt=""><figcaption></figcaption></figure>

1. В поле **Группа или ID группы,** воспользуйтесь функционалом «Вставка значения» и в качестве значения укажите созданное на предыдущем шаге пользовательское поле «ID группы»
2. Введите текст **Сообщения**

Остальные настройки можно оставить по умолчанию. Нажмите на кнопку «Сохранить».

Когда данный бизнес-процесс сработает, активити согласно настройкам обратится в поле «ID группы», получит значение, которое там записано и произведёт отправку в указанную группу:

<figure><img src="../../.gitbook/assets/image (36).png" alt=""><figcaption></figcaption></figure>
