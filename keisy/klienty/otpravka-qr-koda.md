# Отправка QR-кода

Битрикс24 добавил в CRM специального робота «Создать QR-код», который можно отправить клиенту в письме или SMS. В том числе, сформированный QR-код можно отправить клиенту в виде картинки в WhatsApp, воспользовавшись нашим роботом [otpravka-faila.md](../../roboty-i-aktiviti/roboty/otpravka-faila.md "mention").

Применений QR-кодов достаточно много. Вот лишь некоторые из них:

* Регистрация и организация доступа на мероприятия
* Внутренняя пропускная система
* Подтверждение заказа по QR-коду

Рассмотрим ситуацию. Вы проводите мероприятие, для доступа на которое посетитель должен предъявить QR-код на входе. Для создания QR-кода потребуется добавить стандартного робота «Создать QR-код» а затем с помощью робота [otpravka-faila.md](../../roboty-i-aktiviti/roboty/otpravka-faila.md "mention") отправить сформированный QR-код клиенту в WhatsApp. Выполним настройку данного сценария.

Добавьте робота **«Создать QR-код»**. Для этого перейдите в **Роботы ‒ Создать ‒ Выбор стадии ‒ Другие роботы ‒ Создать QR-код ‒ Добавить.**

<figure><img src="../../.gitbook/assets/image (154).png" alt=""><figcaption></figcaption></figure>

Выполните настройку робота. Для этого на добавленном роботе нажмите на кнопку «изменить», чтобы открыть интерфейс редактирования робота.

При необходимости, в разделе «Дополнительные настройки» заполните дополнительные поля. Нажмите на кнопку «СОХРАНИТЬ».

<figure><img src="../../.gitbook/assets/image (156).png" alt=""><figcaption></figcaption></figure>

Затем, добавьте робота **«\[OLChat] WhatsApp - Отправка файла»** и выполните его настройку.

<figure><img src="../../.gitbook/assets/image (157).png" alt=""><figcaption></figcaption></figure>

1. Установите галочку **«после предыдущего робота»**.
2. Укажите **Линию WhatsApp**, через которую планируете сделать отправку
3. Введите **Номер телефона**, на который необходимо отправить сообщение
4. Укажите **Тип источника файла** – Прямая ссылка на файл
5. В поле Прямая ссылка на файл, ID файла на Диске, ID поля необходимо указать дополнительные результаты из робота «Создать QR-код». Кроме того, полученный результат необходимо модифицировать с помощью функции **substr**.

<figure><img src="../../.gitbook/assets/image (159).png" alt=""><figcaption></figcaption></figure>

Значение дополнительного результата «Вставка QR-кода (HTML картинка)» будет иметь вид:

```
{{~A24857_18207_64684_87834:QrImgHtml # Создать QR-код: Вставка QR-кода (HTML картинка)}}
```

Для модификации данного результата необходимо поместить его в следующую конструкцию:

```
{{=substr(ЗНАЧЕНИЕ, 10, -27)}}
```

Итоговая конструкция должна выглядеть следующим образом:

```
{{=substr({{~A24857_18207_64684_87834:QrImgHtml # Создать QR-код: Вставка QR-кода (HTML картинка)}}, 10, -27)}}
```

6. В поле **Подпись** можно написать текст, который будет показан под QR-кодом

<figure><img src="../../.gitbook/assets/image (160).png" alt=""><figcaption></figcaption></figure>

Остальные настройки можно оставить по умолчанию. Нажмите на кнопку «СОХРАНИТЬ».

Сообщение, полученное в WhatsApp будет иметь следующий вид:

<figure><img src="../../.gitbook/assets/image (161).png" alt=""><figcaption></figcaption></figure>
