# Настройка отправки файла в зависимости от источника

При отправке файла с помощью активити или робота «\[OLChat] Отправка файла» и выборе типа источника файла доступны варианты «Прямая ссылка на файл», «Битрикс24.Диск (ID файла)», «Файл из поля CRM» и «Короткая ссылка Битрикс24».

В зависимости от выбранного типа источника необходимо указывать прямую ссылку на файл, ID отправляемого файла или ID поля, в котором находится отправляемый файл.

### Создание прямой ссылки на файл

{% hint style="info" %}
Прямая ссылка, это ссылка вида http://vashsite.ru/file.jpg, \
при переходе по которой **сразу начинается скачивание** файла.

Для создания прямой ссылки файл можно разместить на вашем хостинге (сайте) или использовать один из сервисов хранения файлов, которые предоставляют такую возможность.
{% endhint %}

{% hint style="warning" %}
Через бизнес-процесс нельзя получить прямую ссылку на скачивание файла.

Короткая (публичная) ссылка на файл из Битрикс24 не является прямой ссылкой.

Битрикс24, Dropbox, Google Drive, Яндекс.Диск и другие облачные сервисы, по умолчанию не создают прямые ссылки на скачивание, а создают публичные ссылки с промежуточной страницей, где нужно для загрузки нажать кнопку «Скачать».
{% endhint %}

#### Варианты создания прямых ссылок с помощью сервисов

{% hint style="success" %}
**Dropbox**\
Можно сделать прямую ссылку из обычной изменив параметр ?dl=0 на ?dl=1\
Например, так: https://www.dropbox.com/s/mytoken/myfile.pdf?**dl=1**\
\
**Google Drive**\
Для создания прямой ссылки нужно немного поменять саму ссылку (предварительно открыв доступ к ней).\
Из такой: https://drive.google.com/file/d/**mytoken**/view?usp=sharing\
Сделать такую: https://drive.google.com/uc?export=download\&id=**mytoken**
{% endhint %}

Прямую ссылку на файл с картинкой необходимо также указывать в активити и роботе «WhatsApp - Отправка оформленной ссылки» в поле «Ссылка на превью».

### Указание ID отправляемого файла

ID файла можно увидеть зайдя в Диск. В строке, где расположен файл, в столбце ID указано число — это и есть ID файла, который необходимо указать при отправке.

![](<../.gitbook/assets/image (257).png>)

Также ID файла можно получить в бизнес-процессе, воспользовавшись активити «Детально об объекте Диска».

![](<../.gitbook/assets/image (395).png>)

### Указание ID поля, в котором находится отправляемый файл

Чтобы узнать ID поля, в котором находится отправляемый файл, на вашем портале необходимо перейти по адресу: **CRM — Настройки — Настройки форм и отчётов — Пользовательские поля — Сущность CRM: Лид|Сделка|Контакт|Компания — Список полей.** Выберите необходимо поле и откройте его в режиме редактирования. В браузере в строке ссылки будет указан ID этого поля. Скопируйте его и вставьте в активити бизнес-процесса в поле «Поле файла», как указано выше.

![](<../.gitbook/assets/image (939).png>)

